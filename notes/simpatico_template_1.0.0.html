<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Simpatico.io</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="üöÄ Simpatico: the software application environment of the futureüöÄ!">
  <meta name="author" content="javajosh">
  <meta name="keywords" content="html, css, javascript, es6, tufte, simpatico, web verite">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="stylesheet" href="tufte.css">
  <style>
    /* Uncomment to allow 3rd party embedded content to load */
    /* .iframe-wrapper {display: none;} */
     .iframe-wrapper {border: 1px solid #DDD;}
    button, input {box-sizing: border-box; display: block}
  </style>
</head>

<body>
<!-- If the browser isn't modern and/or doesn't run ES6, ask the user to fix that before running anything else -->
<section class="browser-defense">
  <noscript>
    <p>
      <mark>Please turn on JavaScript to experience the interactivity in the article</mark>
      . Note that this page adheres to strict rules that protect your computer and privacy, including the use of only
      short, simple, elegant resources that are only served from this one domain that I own. I don't use any 3rd party
      trackers or infrastructure services (like a Content Delivery Network, or ), instead relying on excellent code to
      make the user experience world-class.
    </p>
  </noscript>

  <p id='old-browser-warning' style="display:none">
    <mark>Your browser is too old to properly run this page. Please upgrade to a <a
      href="https://www.smashingmagazine.com/2012/07/dear-web-user-please-upgrade-your-browser/">modern browser</a>
    </mark>
    . Thank you.
  </p>

  <script>
    window.onerror = function (e) {
      document.getElementById('old-browser-warning').setAttribute('style', '');
    }
  </script>

  <script>
    // If the browser doesn't support ES6 it will fail to parse this short script and trigger the onerror handler above.
    // It will also trigger if you have a general syntax error in your initialization or handler code.
    let foo = 1;
    const bar = 2;
    const sum = (a, b) => a + b;
    if (sum(foo, bar) !== 3) throw 'Bad math processing exception';
  </script>
</section>

<!-- A very simple menu that navigates between home, about and contact, the three "entry points" to this site. -->
<!-- This assumes common UI - trivial to get if we copy and paste. -->
<nav class="menu">
  <ol>
    <li class="menu-item"><a href="./home.html">Ô∏èHome</a></li>
    <li class="menu-item"><a href="./about.html">About</a></li>
    <li class="menu-item"><a href="./contact.html">Contact</a></li>
  </ol>
</nav>

<article class="post" id="simple">
  <header>
    <h1>‚ò∏ A Simple Post</h1>
    <p class="subtitle">By
      <span class="author">javajosh</span>
      <time datetime="2021-03-13 14:40">2021-03-13 15:40</time>
    </p>
    <div class="epigraph">
      <blockquote>
        <p>Forgive the length of this letter, but I did not have time to write a shorter one.</p>
        <footer>-Blaise Pascal</footer>
      </blockquote>
    </div>
  </header>
  <section>
    <p>
      <span class="newthought">A beginning is a very delicate time. <label for="sn-a-beginning" class="margin-toggle sidenote-number"></label></span>
      <input type="checkbox" id="sn-a-beginning" class="margin-toggle">
      <span class="sidenote">This quote is from Princess Irulan in Frank Herbert's epic <a href="http://alibris.com/dune"><em>Dune Novels</em></a></span>. David Lynch's amazing 80's Dune, begins with these words.
      tags.
    </p>

    <p>In general, I'll probably want to introduce another resource in an iframe wrapper like this
    </p>
    <figure class="iframe-wrapper">
      <iframe id="util-html" src="./utils.html" title="Util Tests" frameborder="0" scrolling="no"  allowtransparency="true" allowfullscreen></iframe>
    </figure>
    <p>(Right away we can see some opportunities to improve the test runner, at least by putting something in the DOM to indicate success or failure. Perhaps just setting the background color?)</p>

    <p>BTW do we really want to add new posts to the top?</p>
  </section>
</article>

<article class="post" id="tufte">
  <header>
    <h1>‚ò∏ Tufte, SVG and Me</h1>
    <p class="subtitle">By
      <span class="author">javajosh</span>
      <time datetime="2021-03-13 14:40">2021-03-13 14:40</time>
    </p>
    <div class="epigraph">
      <blockquote>
        <p>Sometimes we begin a piece with an ambiguous quote from someone moderately famous to create a false sense of connection between the author and that more famous person. Plus it reminds me of Frank Herbert's Dune novels.</p>
        <footer>javajosh, ‚ÄúTufte, SVG and Me‚Äù</footer>
      </blockquote>
    </div>
  </header>
  <section>
    <p>
      <span class="newthought">In his <label for="sn-in-his-later-books" class="margin-toggle sidenote-number">later books</label></span>
      <input type="checkbox" id="sn-in-his-later-books" class="margin-toggle">
      <span class="sidenote"><a href="http://www.edwardtufte.com/tufte/books_be"><em>Beautiful Evidence</em></a></span>,
      Tufte starts each section with a bit of vertical space, a non-indented paragraph, and the first few words of the
      sentence set in small caps. For this we use a span with the class <code>newthought</code>, as demonstrated at the
      beginning of this paragraph. Vertical spacing is accomplished separately through <code>&lt;section&gt;</code>
      tags.
    </p>

    <p>It's really nice to have good figures.
      Here is a figure that contains an iframe that itself is running another component.
      In this case, <code>core.html</code> is loaded, which is just running unit tests over and over again:
    </p>
    <figure class="iframe-wrapper">
      <iframe id="core-html" src="./core.html" title="Simpaticore Tests" frameborder="0" scrolling="no"  allowtransparency="true" allowfullscreen></iframe>
    </figure>
    <p>(Right away we can see some opportunities to improve the test runner, at least by putting something in the DOM to indicate success or failure. Perhaps just setting the background color?)</p>

    <p>Lets see how we can do that with
      <label for="codepen-checkbox" class="margin-toggle sidenote-number">codepen</label>:
      <input type="checkbox" id="codepen-checkbox" class="margin-toggle">
      <span class="marginnote">A wonderful SVG animation From <a href="https://codepen.io/jjperezaguinaga">JJ Perez on CodePen</a>. Note that you can edit this code in place to see how it works!</span>
    </p>
    <figure class="iframe-wrapper">
      <iframe id="codepen-svg" scrolling="no" title="SVG Animation"
              data-src="https://codepen.io/jjperezaguinaga/embed/yuBdq?height=480&theme-id=light&default-tab=result"
              frameborder="0" allowtransparency="true" allowfullscreen>
      </iframe>
      <p><i>codepen disabled</i></p>
    </figure>

    <p>Here is an SVG image that is:</p>
    <ol>
      <li>defined inline</li>
      <li>major and minor grid</li>
      <li><em>normalized</em> coordinate system. the origin is in the center, y is up, and the unit circle covers the viewable area.</li>
      <li>The controls are tucked away in a marginnote!</li>
    </ol>
    <p>Lets see how we can do that with
      <label for="clock-checkbox" class="margin-toggle sidenote-number">an inline svg thing, a clock</label>:
      <input type="checkbox" id="clock-checkbox" class="margin-toggle">
      <span class="marginnote">
        <button id="btn-up">Up</button>
        <button id="btn-down">Down</button>
        <button id="btn-start">Start üü¢</button>
        <button id="btn-stop">Stop üî¥</button>
        <input  id="range-x" step=.1 type="range" min=-1 max=1>
        <input  id="range-y" step=.1 type="range" min=-1 max=1>
      </span>
      Here is the clock itself:
    </p>

    <figure>
      <svg id="figure-clock" width="500" height="500" viewBox="-405 -405 806 806" style="border: none">
        <defs>
          <!-- Make a major/minor grid -->
          <pattern id="smallGrid" width="8" height="8" patternUnits="userSpaceOnUse">
            <path d="M 8,0 L 0,0 0,8" fill="none" stroke="gray" stroke-width=".5"/>
          </pattern>
          <pattern id="grid" width="80" height="80" patternUnits="userSpaceOnUse">
            <rect width="80" height="80" fill="url(#smallGrid)"/>
            <path d="M 80,0 L 0,0 0,80" fill="none" stroke="gray" stroke-width="1"/>
          </pattern>

          <!-- Marks for vectors-->
          <marker id="start" markerWidth="5" markerHeight="5" refX="2.5" refY="2.5">
            <circle cx="2.5" cy="2.5" r="2.5" fill="black" stroke="black"/>
          </marker>
          <marker id="stop" markerWidth="20" markerHeight="10" refX="20" refY="5" orient="auto">
            <path d="M0,0 L20,5 0,10 5,5 Z" fill="black"/>
          </marker>
        </defs>

        <!-- Draw the grid -->
        <rect x="-400" y="-400" width="100%" height="100%" fill="url(#grid)"/>

        <!-- Draw a sample vector from the origin -->
        <line class="vector" stroke="black" marker-start="url(#start)" marker-end="url(#stop)"/>
        <line class="vector" stroke="black" marker-start="url(#start)" marker-end="url(#stop)"/>
        <line class="vector" stroke="black" marker-start="url(#start)" marker-end="url(#stop)"/>
        <line class="vector" stroke="black" marker-start="url(#start)" marker-end="url(#stop)"/>

        <!-- Now lets draw on the grid in a mostly normalized way -->
        <g transform="scale(4,-4)">
          <path d="M 0,0 L 100,100" stroke-width=".1" stroke="red" fill="none"/>
          <path d="M 0,100 L 100,0" stroke-width=".1" stroke="blue" fill="none"/>
          <circle r="100" cx="0" cy="0" fill="blue" opacity=".1" stroke="black" stroke-width=".1"/>
          <circle id="small-red-circle" r="5" cx="10" cy="10" fill="red" opacity=".3" stroke="gray" stroke-width=".1"/>
        </g>
      </svg>
      <script>
        'use strict';
        // Log and SVG utils
        const LOG_ENABLED = true;
        console.log("LOG_ENABLED", LOG_ENABLED);
        const log = function () {
          if (LOG_ENABLED) console.log.apply(console, arguments);
          return true;
        };
        const debug = function () {
          if (LOG_ENABLED) console.debug.apply(console, arguments);
          return true
        };
        const warn = function () {
          if (LOG_ENABLED) console.warn.apply(console, arguments);
          return true
        };
        const info = function () {
          if (LOG_ENABLED) console.info.apply(console, arguments);
          return true
        };
        const error = function () {
          if (LOG_ENABLED) console.error.apply(console, arguments);
          return true
        };

        const getAttr = (elt, attr) => elt.getAttribute(attr) * 1;
        const setAttr = (elt, attr, val) => debug(elt, attr, val) && elt.setAttribute(attr, val);
        const incAttr = (elt, attr, delta) => setAttr(elt, attr, getAttr(elt, attr) + delta);
        const isCircle = elt => elt.tagName === 'circle';
        const elt = document.getElementById.bind(document);
        const elts = document.querySelectorAll.bind(document);
        const ms = 1, px = 1; // Descriptive units

        let running = true; // True when the animation is running; false when it is stopped.
        let lastT = 0, ticks = 0;

        // Clicking the buttons starts and stops the animation
        elt('btn-start').onclick = e => {
          running = true;
          animateVectors(elts('.vector'));
        };
        elt('btn-stop').onclick = e => running = false;

        // Clicking buttons moves the red circle relatively
        const circle = elt('small-red-circle');
        elt('btn-up').onclick = e => incAttr(circle, 'cy', 1);
        elt('btn-down').onclick = e => incAttr(circle, 'cy', -1);

        // Dragging the slider moves a circle absolutely
        elt('range-x').oninput = e => setAttr(circle, 'cx', e.target.value);
        elt('range-y').oninput = e => setAttr(circle, 'cy', e.target.value);

        // Clicking any circle moves it up and to the right a little, relatively
        elt('figure-clock').onmousedown = e => {
          if (isCircle(e.target)) {
            incAttr(e.target, 'cx', 1);
            incAttr(e.target, 'cy', 1);
          }
        };

        function animateVectors(vectors, config = {
          min_interval: 100 * ms, //raf runs at ~17ms which is too fast for our needs.
          radius: 400 * px,
        }) {
          const {min_interval, radius} = config;

          const tick = t => {
            if (min_interval <= t - lastT) {
              info('lastT', 'ticks', lastT, ticks);
              ticks++;
              lastT = t;

              vectors.forEach((v, i) => {
                i = i + 1;
                setAttr(v, 'x2', 1 / i * radius * Math.cos(i * ticks / min_interval));
                setAttr(v, 'y2', 1 / i * radius * Math.sin(i * ticks / min_interval));
              });
            }
            if (running) {
              window.requestAnimationFrame(tick);
            }
          }
          tick(lastT);
        }

        animateVectors(elts('.vector'));

      </script>
    </figure>
  </section>
</article>


<footer>Copyright 2021 javajosh, All Rights Reserved.
  <hr>
  <em>Colophon:</em> HTML5, ES6, CSS3, SVG1.1, Unicode, UTF8, JSON, macOS 11, SublimeText 3, TCP/IP, HTTP 1.1, Ubuntu, Node, OpenJDK, nginx, Docker, Github, Digital Ocean, Namecheap <a href="https://edwardtufte.github.io/tufte-css/">Tufte CSS</a>, heavily modified.
</footer>
</body>
</html>
