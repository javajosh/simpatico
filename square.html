<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Green Square</title>
</head>

<body>

  <h2>Things you can do:</h2>
  <ol>
    <li><a href="https://duckduckgo.com/?q=how+to+open+browser+developer+console">Open the dev console</a> and invoke <code>setX(10)</code>, <code>setX(-10)</code>, <code>setY(10)</code> or <code>setY(-10)</code></li>
    <li>Hit the left and right arrow keys</li>
    <li>Watch the pretty animation.</li>
    <li>Start and stop the animation with the 's' key.</li>
    <li>Start and stop the animation with <code>animate()</code> in the console.</li>
  </ol>

  <svg width="500" height="500">
    <rect id="1" x="0" y="0" width="100" height="100" fill="green" />
  </svg>

  <script>
  // Give the user something to do at the console.
  function setX(val, inc = true) {
    if (typeof val !== 'number') throw new Error(`${val} is not a number`);
    const base = inc ? 1 * document.getElementById('1').getAttribute('x') : 0;
    document.getElementById('1').setAttribute('x', base + val);
  }

  function setY(val, inc = true) {
    if (typeof val !== 'number') throw new Error(`${val} is not a number`);
    const base = inc ? 1 * document.getElementById('1').getAttribute('y') : 0;
    document.getElementById('1').setAttribute('y', base + val);
  }

  // Give the user something to do with the keyboard.
  document.body.addEventListener('keyup', e => {
    if (e.key === 'ArrowUp') setY(-10);
    if (e.key === 'ArrowDown') setY(10);
  });

  document.body.addEventListener('keyup', e => {
    if (e.key === 'ArrowRight') setX(10);
    if (e.key === 'ArrowLeft') setX(-10);
  });

  // Now lets output circular motion. 
  const ms = 1;
  const s = 1000 * ms;
  const period = 5 * s;
  const magnitude = .5;
  const [dx, dy] = [0, 0];

  let timerID = 0;

  function animate() {
  	if (timerID) return timerID;
    timerID = setInterval(e => {
      const t = Date.now();
      const theta = t * 2 * Math.PI / period;
      const [x, y] = [Math.cos(theta), Math.sin(theta)];
      // Yay, we can set the thing.
      setX(x * magnitude + dx);
      setY(y * magnitude + dy);
    }, 17 * ms);
    return timerID;
  }
  animate();

  // Allow the user to start and stop with the s key.
  document.body.addEventListener('keyup',
    e => {
      if (e.key === 's') {
        timerID = timerID ? clearInterval(timerID) : animate();
      }
    });

  </script>
</body>

</html>
